<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SVG 2 PNG</title>
  <style>
    body{
      font-family:sans-serif;padding:2rem;
      background:#111;color:#fff;border-radius:12px;
      user-select:none
    }
    input{margin-top:1rem;display:block}
    #output{margin-top:1rem;max-width:100%;-webkit-user-drag:none;cursor:pointer}
  </style>
</head>
<body>

<h2 style="margin:0">SVG 2 PNG</h2>
<input type="number"id="px"placeholder="px"value="512"min="1">
<input type="file"id="svg"accept=".svg">
<img id="output"style="background:#222">
<canvas id="canvas"style="display:none;"></canvas>

<script>
  const px=document.getElementById('px');px.value=Number(localStorage.px)||px.value;
  const svg=document.getElementById('svg');
  const output=document.getElementById('output');
  var cFile;
  const convert=(f)=>{
    const size=Math.min(Math.max(parseInt(px.value),1),1024*16)||512;
    px.value=localStorage.px=size;
    const file=f||svg.files[0]||cFile;if(!file)return alert('Choose SVG file');
    cFile=file;
    const reader=new FileReader();
    reader.onload=function(e){
      const svgContent=e.target.result;
      const svgBlob=new Blob([svgContent],{type:'image/svg+xml;charset=utf-8'});
      const url=URL.createObjectURL(svgBlob);
      const img=new Image();
      img.onload=function(){
        const canvas=document.getElementById('canvas');
        const ctx=canvas.getContext('2d');
        //const size=Math.min(Math.max(parseInt(px.value),1),1024);
        px.value=canvas.width=canvas.height=size;
        ctx.drawImage(img,0,0,size,size);
        output.src=canvas.toDataURL('image/png');
        output.style.display='block';
        URL.revokeObjectURL(url);
        output.onclick=()=>{
          const link=document.createElement('a');
          link.download=file.name.replace('.svg','.png')
          link.href=canvas.toDataURL('image/png');
          link.click();
        }
      };
      img.src=url;
    };
    reader.readAsText(file);
  }
  px.onchange=svg.onchange=()=>convert();
  window.ondragover=e=>{
    e.preventDefault();
    const items=e.dataTransfer.items;
    const[item]=items;//console.log(item);
    document.body.style.boxShadow=
    item.kind=='file'&&item.type.startsWith('image/svg')&&items.length==1
    &&'0 0 0 3px #69ff69'||'0 0 0 3px #ff6969';
  };
  window.ondragleave=e=>{
    e.preventDefault();if(e.fromElement)return;
    document.body.style.boxShadow=null;
  }
  window.ondrop=e=>{
    e.preventDefault();
    document.body.style.boxShadow=null;
    const files=e.dataTransfer.files;if(files.length>1)return alert("1 SVG file only");
    const[file]=files;//console.log(file);
    if(!(file.type.startsWith('image/svg')&&file.name.endsWith('.svg')))return alert(".svg file only");
    return convert(file);
  }
</script>
</body>
</html>
